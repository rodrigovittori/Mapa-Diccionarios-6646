# [M5.L1] - Actividad #5: "Llave"

""" Objetivo: Implementar una nueva condici√≥n de victoria:
              el jugador DEBE encontrar la llave para poder activar la Salida

Pasos:

1¬∫) Modificar nuestro diccionario para que cada clave se asocie a un DICCIONARIO (no listas)
    > Cada habitaci√≥n ahora ser√° un diccionario con DOS CLAVES:
                                                                * Lista de Habitaciones Accesibles
                                                                * Lista de √çtems presentes en la habitaci√≥n actual

2¬∫) Modificar condici√≥n para terminar el bucle principal: 
                                                         A) el jugador DEBE haber derrotado al Boss*
                                                         B) el jugador DEBE estar en "Salida"

                                                         * Nota: Para derrotar al Boss deberemos encontrar un √≠tem
                                                         
    > crearemos una variable que represente el √≠tem necesario para salir
    > crearemos un "inventario" (lista) para el jugador
    > finalmente cuando el jugador desee acceder a la Salida deber√° poseer el √≠tem requerido
    
    NOTA: Por cuestiones de din√°mica de clase cambiaremos las condiciones para que el √≠tem "derrote" a nuestro "Boss"

3¬∫) Modificar sistema de transici√≥n entre habitaciones
4¬∫) Implementar sistema de recolecci√≥n de √≠tems
5¬∫) Modificar sistema de listado de habitaciones contiguas / accesibles
"""

from time import sleep # Para pausas dram√°ticas

mapa = {
        # 1¬™ CLAVE (mapa) :    VALOR (otro diccionario)
        #                       2¬∫ diccionario (cada habitacion es un diccionario con sus propias listas)
        #                       lista_habitaciones, lista_items, (pueden agregar: lista_trampas y/o lista_enemigos)
        'Spawn'           : { 'lista_habitaciones' : ['1', '2'], 'lista_items' : [] },
        '1'               : { 'lista_habitaciones' : ['Spawn', '3', '4'], 'lista_items' : ["Hacha oxidada"] },
        '2'               : { 'lista_habitaciones' : ['Spawn', '4'], 'lista_items' : ["Chocolate"] },
        '3'               : { 'lista_habitaciones' : ['1'], 'lista_items' : [] },        # <<--- AGREGAR ITEM NECESARIO A ESTA SALA
        '4'               : { 'lista_habitaciones' : ['1', '2', 'Boss'], 'lista_items' : ["Replica"] },
        'Boss'            : { 'lista_habitaciones' : ['4', 'Salida'], 'lista_items' : [] },
        'Salida'          : { 'lista_habitaciones' : ['Boss'], 'lista_items' : [] }
        }

####################################################################
# DECLARACI√ìN DE VARIABLES

# Paso 1) Seteamos habitaci√≥n inicial ("Spawn")
habitacion_actual = "Spawn"

# Paso 2) Definir el item necesario para poder ganar el juego:
item_requerido = "Pollito KFC" # Necesitaremos un "Arma Legendaria" para derrotar al Boss

# Vamos a colocarlo en la habitaci√≥n '3':
mapa['3']["lista_items"].append(item_requerido)

# Ya que tendremos que registrar √≠tems no hay motivo para no crear un inventario para nuestro PJ
inventario_personaje = []

# Agreguemos ahora una variable que registre si hemos obtenido el √≠tem requerido:
tiene_item_requerido = False

# Agreguemos tambi√©n una segunda condici√≥n para saber si hemos derrotado al boss:
boss_derrotado = False

nombre_boss = "Mr. DiplomongUs"

####################################################################
# BUCLE PRINCIPAL DE JUEGO:

while (not (boss_derrotado and (habitacion_actual == "Salida"))): # To-do: Agregar condici√≥n para salir del bucle

    ################################################################################################################
    # >> INVENTARIO:

    # Verificamos si nuestro personaje tiene (o no) el √≠tem requerido:
    tiene_item_requerido = (item_requerido in inventario_personaje)

    # Mostramos inventario
    if (len(inventario_personaje) > 0): # Si tenemos alg√∫n √≠tem:
        print("Inventario: ", inventario_personaje)

    ################################################################################################################
    
    # Mostramos habitaci√≥n actual: 
    print("\n===================================")
    print(" Te encuentras en la habitaci√≥n:", habitacion_actual)

    # Mostramos habitaciones disponibles/accesibles:
    print("\n Puedes ir a: ")
    for habitacion_contigua in mapa[habitacion_actual]["lista_habitaciones"]:
        print("> ", habitacion_contigua)

    ########################################################################
    # SOLICITAR HABITACI√ìN DESTINO:
    habitacion_destino = input("\n ¬øA que habitacion iras ahora?: ")

    if (habitacion_destino not in mapa[habitacion_actual]["lista_habitaciones"]):
        # Si la habitaci√≥n elegida por el usuario NO est√° en la lista asignada a mi clave actual...
        print("¬°No puedes hacer eso!, \"", habitacion_destino, "\" NO es accesible desde aqu√≠.")
        sleep(2)
        continue

    # Condici√≥n para "terminar" el juego:
    elif (habitacion_destino == "Salida"):
        if (boss_derrotado):
            print("¬°Felicitaciones! Has derrotado al malo malvado y el reino ha sido salvado :D")
            print(" [GOOD ENDING] ")
            print("¬°Eres libre!")
            sleep(2)
            break
        else:
            print(" No esperaba √©sto: [ENDING NEUTRAL: SALIDA EQUIVOCADA]")

    ########################################################################
    # Condiciones del Boss
    elif ((habitacion_destino == "Boss") and (tiene_item_requerido)):
        print("Armado con valor sabiendo que tienes lo necesario para liberar este mundo de la crueldad de ", nombre_boss, ", entras al Gran Sal√≥n.")
        #print("üéüÔ∏è *vale por una pelea epica* - *toi cansado jefe*")
        
        for _ in range (3):
            sleep(1)
            print("...")

        print("Un escalofr√≠o recorre tu espalda y te congelas al escuchar una voz estremecedora inquerir:")
        print("> ¬øQUIEN OSA ADENTRARSE EN MI GUARIDA? ¬øACASO SE ATREVEN A DESAFIAR EL PODER DE ", nombre_boss, "?" )

        sleep(2)
        print("\n Incapaces de responder nuestros h√©roes se quedan ah√≠ sosteniendo ", item_requerido)

        sleep(3)
        print(" *con voz amable* > Oh! Mi pollito! Me mor√≠a de hambre, perd√≥n es que no recibo muchas visitas ultimamente...")
        print(" *toma la bolsa y te da un pu√±ado de oro*  > Eso deber√≠a ser suficiente, AHORA VETE! ")

        inventario_personaje.append("monedas de oro")

        sleep(2)
        print(nombre_boss, " procede a devorar su ", item_requerido)
        print("Lo que √©l no sab√≠a es que esa deliciosa salsa no era s√≥lo de ar√°ndanos... ¬°Ten√≠a veneno de medusas!")

        sleep(3)
        print("> AAAAHHHH! Noooooo, MI DEBILIDAD SECRETA! ¬ø¬° COMO LO SUPISTE?! ")

        sleep(2)
        print(" ** Antes de que nuestros h√©roes comenten sobre el peligroso viaje en el que se embarcaron para conseguir un vial de veneno de medusas en el reino submarino de Khat-Mazal el malo continua **")
        print("\n RAYOS, TRUENOS, CENTELLAS, ¬°AR√ÅNDANOS! MI DEBILIDAD ZOI ALERGICO DESDE PEQUE√ëO BUAAAAH")
        
        boss_derrotado = True
        habitacion_actual = "Salida"
        sleep(4)
        continue

    elif ((habitacion_destino == "Boss") and (not tiene_item_requerido)):
        print("La presencia del malo malvado es tan mal√©ficamente malvada que tus piernas se vuelven blandas como malvaviscos y no puedes obligarte a entrar.")
        print("A√öN NO ESTAS LISTO, NECESITAS, ", item_requerido, ", ENCU√âNTRALO, ¬°R√ÅPIDO!")
        habitacion_actual = '4'
        sleep(4)

    else:
        # Si la habitacion ES v√°lida y NO es la salida: cambiamos de habitaci√≥n
        habitacion_actual = habitacion_destino

    ################################################################################################################
    # RECOLECCI√ìN DE √çTEMS:

    """
    Paso 1: Ver si hay items
    Paso 2: Ver si es el item requerido, de ser as√≠ mostrar mensaje epicardo bro
    Paso 3: Agregar el item al inventario del PJ (sin importar si es el item requerido o no)
    Paso 4: Eliminar el √≠tem del mapa (para evitar √≠tems infinitos)
    """

    if ( len(mapa[habitacion_actual]["lista_items"]) > 0 ):          # Si hay items en esta habitaci√≥n:
        for item in mapa[habitacion_actual]["lista_items"]:          # iteramos sobre los items...

            ########################################################################
            # MENSAJES DE √çTEMS:
            
            if item == item_requerido:
                print("¬°FELICIDADES! Has conseguido el √≠tem requerido: ", item_requerido)
                print("Toma este vale por un mensaje con m√°s epicidad: üéüÔ∏è")
                sleep(3)

            elif item == "Chocolate":
                print("\n\nRevisando la habitaci√≥n encuentras un ladrillo suelto en la pared de piedra...")
                sleep(3)
                print("Detr√°s de √©l, un alijo escondido con joyas y otras cosas que simplemente dejas a un lado...")
                sleep(3)
                print("Sin embargo, en un delicado envoltorio encuentras una raci√≥n extra√±a.")
                sleep(2)
                print("\n Hesitante, lo muerdes e inmediatamente un DELICIOSO sabor invade tu boca.")
                sleep(2)
                print("Su textura aterciopelada derriti√©ndose en tu leng√ºa,\n",
                      "ese comfort c√°lido que te recuerda las ma√±anas de tu infancia,\n",
                      "bocado a bocado sientes como este delicioso √≠tem restaura tus fuerzas.")
                sleep(10)
                print("Con mucho esfuerzo te recuerdas la importancia de tu misi√≥n y el peligro que te rodea...")
                sleep(3)
                print("Decides guardar el resto para m√°s tarde. \n\n")
                sleep(2)

            elif item == "Replica":

                print("\n\nEn una estanter√≠a encuentras una peque√±a caja olvidada.")
                sleep(3)
                print("Tras un breve sobresalto que te genera una ara√±a que hab√≠a hecho",
                      "de esa caja su hogar al levantar la caja sientes que hay algo dentro de ella.")
                sleep(5)
                print("Encuentras una incre√≠blemente detallada r√©plica de madera de un rev√≥lver.")
                sleep(3)
                print("Te tomas unos minutos para revisar los intrincados detalles labrados...")
                sleep(3)
                print("Aunque s√≥lo se trate de una r√©plica de madera, comprendes que dentro de ella hay un GRAN poder.")
                sleep(5)
                print("Decides llevarla contigo, aunque sea para tranquilizar tus nervios. \n\n")
                sleep(2)
            
            inventario_personaje.append(item)                        # Agregamos el √≠tem al inventario del PJ
            print("Has recibido el √≠tem: ", item)
            mapa[habitacion_actual]["lista_items"].remove(item)      # Eliminamos el item del mapa

####################################################################################################################

####################################################################
# FIN DE BUCLE PRINCIPAL

print("\n===================================")
print("\n > FIN DEL JUEGO <")